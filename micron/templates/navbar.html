{% load i18n %}
{% load static %}

{% block css %}
<style>
    #language-select {
    font-size: 16px;
    border: 1px solid #ccc;
    border-radius: 5px;
    width: 120px;
    cursor: pointer;
}

#language-select option {
    padding: 10px;
    background-color: #fff;
    color: #333;
}

#language-select option:checked {
  background-color: #007bff;
  color: #fff;
}

.navbar {
    margin-top: -40px;

}

.nav-item{
    color: #000;
}


.form-control:focus {
        border-color: black !important;
        box-shadow: none; /* Optionally, you can remove the box-shadow */
}

.dropdown-divider {
    border-top: 1px solid rgba(0, 0, 0, 0.5);
    margin: 5px 0;
}

</style>
{% endblock %}

<nav class="navbar navbar-expand-lg navbar-light bg-light">
            <div class="container px-4 px-lg-5">
                <img width="5%" src="{% static 'images/logo.png' %}"><a class="navbar-brand" href="/">{% trans 'ùë¥ùíäùíÑùíìùíêùíè' %}</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0 ms-lg-4">
                        <li class="nav-item"><a class="nav-link active" aria-current="page" href="/">{% trans 'Products' %}</a></li>
                        <li class="nav-item"><a class="nav-link" href="{% url 'orders:orders' %}">{% trans 'Orders' %}</a></li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" id="navbarDropdown" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">{% trans 'Categories' %}</a>
                            <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                                <li><p class="dropdown-item">All Categories</p></li>
                                <li><hr class="dropdown-divider" /></li>
                                {% for category in all_categories %}
                                <li><a class="dropdown-item" href="{{ category.get_absolute_url }}">{{ category.name|capfirst }}</a></li>
                                {% endfor %}
                            </ul>
                        </li>
                        {% if user.is_authenticated %}
                          <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" id="navbarDropdown" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false"> <img src="{% if user.image %} {{ user.image.url }} {% else %} {% static 'images/users/avatar.png' %}  {% endif %}" alt="mdo" width="24" height="24" class="rounded-circle"></a>
                            <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                                <li><p class="dropdown-item">{{ user }}'s Profile</p></li>
                                <li><hr class="dropdown-divider"/></li>
                                <li class="nav-item"><a class="nav-link active" aria-current="page" href="{% url 'user_account:profile' %}">{% trans 'Profile' %}</a></li>
                                <li class="nav-item"><a class="nav-link active" aria-current="page" href="{% url 'products:favorite_products' %}">{% trans 'Favourite Products' %}</a></li>
                                <li class="nav-item"><a class="nav-link active" aria-current="page" href="{% url 'user_account:password_change' %}">{% trans 'Change Password' %}</a></li>
                                <li class="nav-item"><a class="nav-link active" aria-current="page" href="{% url 'user_account:logout' %}">{% trans 'Logout' %}</a></li>
                                {% if user.is_superuser or user.is_staff %}
                                <li class="nav-item"><a class="nav-link active" aria-current="page" href="{% url 'admin:index' %}">{% trans 'Admin Panel' %}</a></li>
                                {% endif %}
                            </ul>
                        </li>
                        {% else %}
                        <li class="nav-item"><a class="nav-link" href="{% url 'user_account:login' %}"><i class="fa-solid fa-user"></i></a></li>
                        {% endif %}
                        <li class="nav-item">
                            <div class="d-flex align-items-center">
                                <form action="{% url 'set_language' %}" method="post" class="nav-link d-inline">
                                    {% csrf_token %}
                                    <input name="next" type="hidden" value="{{ request.get_full_path }}">
                                    <select name="language" id="language-select" onchange="this.form.submit()">
                                        {% get_current_language as LANGUAGE_CODE %}
                                        {% get_available_languages as LANGUAGES %}
                                        {% get_language_info_list for LANGUAGES as languages %}
                                        {% for language in languages %}
                                            <option value="{{ language.code }}" {% if language.code == LANGUAGE_CODE %}selected{% endif %}>
                                                {{ language.name_local }}
                                            </option>
                                        {% endfor %}
                                    </select>
                                </form>
                            </div>
                        </li>
                    </ul>
                    <div class="collapse navbar-collapse" id="navbarNavDropdown">
                        <form class="d-flex" id="searchform" action="{% url 'products:products' %}" method="get">
                            <div class="input-group">
                                <div class="input-group-prepend" style="cursor: pointer;" onclick="document.getElementById('searchform').submit();">
                                    <span class="input-group-text">
                                        <i class="fa-solid fa-magnifying-glass"></i>
                                    </span>
                                </div>
                                <input class="form-control me-sm-2" type="search" name="search_query" value="{{ search_query }}" placeholder="Search">
                            </div>
                        </form>
                    </div>
                    <form action="{% url 'cart:cart_summary' %}" method="POST" class="d-flex">
                        {% csrf_token %}
                        <button class="btn btn-outline-dark" type="submit">
                            <i class="bi-cart-fill me-1"></i>
                            {% trans 'Cart' %}
                            <span class="badge bg-dark text-white ms-1 rounded-pill">
                                {% with qty_amount=cart|length %}

                                {% if qty_amount > 0 %}

                                    {{ qty_amount }}

                                    {% else %}

                                        0

                                    {% endif %}

                        {% endwith %}</span>
                        </button>
                    </form>
                </div>
            </div>
</nav>
<body>
    <div class="container">
        {% for message in messages %}
        {% if message.level == DEFAULT_MESSAGE_LEVELS.SUCCESS %}
            <h6 id="message-timer" class="alert alert-success text-center"><i class="fa fa-sign-out" aria-hidden="true"></i> &nbsp; {{ message }}</h6>
        {% endif %}

         {% if message.level == DEFAULT_MESSAGE_LEVELS.ERROR %}

            <h6 id="message-timer" class="alert alert-danger text-center"> <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>  &nbsp; {{ message }}</h6>

        {% endif %}

        {% if message.level == DEFAULT_MESSAGE_LEVELS.INFO %}

            <h6 id="message-timer" class="alert alert-info text-center"><i class="fa fa-check-circle" aria-hidden="true"></i>  &nbsp; {{ message }}</h6>
        {% endif %}

    {% endfor %}
    </div>
</body>

<script src="{% static 'js/app.js' %}"></script>

<script>
window.onbeforeunload = function() {
    navigator.sendBeacon('/decrement-counter/');
};
</script>